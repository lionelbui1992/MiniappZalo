var v=(s,o,d)=>new Promise((m,l)=>{var g=u=>{try{c(d.next(u))}catch(y){l(y)}},b=u=>{try{c(d.throw(u))}catch(y){l(y)}},c=u=>u.done?m(u.value):Promise.resolve(u.value).then(g,b);c((d=d.apply(s,o)).next())});import{a as J,g as Q,c as V,S as U,I as K,b as A,_ as X,d as Y,e as Z,p as ee,s as te,o as ae,f as ne,u as se,h as re,B as le}from"./index.9875b35f.module.js";import{x as ce,R as e,I as ie,B as h,b as oe,f as C,d as q,r as p,P as de,T as S,S as F,h as ue,a as me}from"./vendor.1c49cccd.module.js";const Ee=(s,o)=>new Promise((d,m)=>{ce.createOrder({desc:o!=null?o:`Thanh to\xE1n cho ${J.app.title}`,item:[],amount:s+Number(Q(l=>l.template.shippingFee)),success:l=>v(void 0,null,function*(){console.log("Thanh to\xE1n th\xE0nh c\xF4ng:",l)}),fail:l=>{console.log("L\u1ED7i thanh to\xE1n:",l),m(l)}})}),he=[{name:"detail",label:"S\u1ED1 nh\xE0, t\xEAn \u0111\u01B0\u1EDDng",type:"text",placeholder:"Nh\u1EADp s\u1ED1 nh\xE0, t\xEAn \u0111\u01B0\u1EDDng",errorMessage:"H\xE3y nh\u1EADp \u0111\u1ECBa ch\u1EC9 c\u1EE5 th\u1EC3 c\u1EE7a b\u1EA1n",isValidate:!0},{name:"city",label:"T\u1EC9nh, th\xE0nh ph\u1ED1",type:"select",placeholder:"Ch\u1ECDn t\u1EC9nh, th\xE0nh ph\u1ED1...",isValidate:!1},{name:"district",label:"Qu\u1EADn (huy\u1EC7n)",type:"select",placeholder:"Ch\u1ECDn qu\u1EADn, huy\u1EC7n...",isValidate:!1},{name:"ward",label:"Ph\u01B0\u1EDDng (x\xE3)",type:"select",placeholder:"Ch\u1ECDn ph\u01B0\u1EDDng, x\xE3...",isValidate:!1}],pe=({store:s,type:o="standard",handleOnClick:d=()=>{},hasRightSide:m=!0,hasBorderBottom:l=!0,customRightSide:g,className:b})=>e.createElement("div",{key:s.id,className:V("flex flex-row items-center justify-between w-full",l&&" border-b",b&&b),onClick:d,role:"button"},e.createElement("div",{className:"flex flex-row items-center"},e.createElement("div",{className:"w-auto flex-none"},e.createElement("img",{src:s.logoStore,alt:"product",className:" w-9 h-9 object-cover rounded-full bg-white"})),e.createElement("div",{className:" p-3 pr-0"},e.createElement("div",{className:"line-clamp-2 text-sm font-medium break-words"},s.nameStore),o==="standard"&&e.createElement("span",{className:" pt-1 font-semibold text-sm text-gray-500"},U[s.type]))),m&&(g||e.createElement(ie,{size:20,icon:"zi-chevron-right",className:" text-zinc-500"}))),xe=({id:s,pathImg:o,nameProduct:d,salePrice:m,quantity:l,handleOnClick:g})=>e.createElement("div",{className:"w-full flex flex-row items-center justify-between gap-1 border border-[#E4E8EC] rounded-lg overflow-hidden h-24 p-2 mt-2 bg-white",onClick:()=>g(s),role:"button"},e.createElement("div",{className:"flex flex-row items-center gap-1"},e.createElement("div",{className:"flex-none w-20 rounded-lg overflow-hidden"},e.createElement(K,{src:o,alt:"image product",ratio:1})),e.createElement(h,{p:0,m:0,className:" flex-none relative w-5 h-5 rounded-full bg-slate-100"},e.createElement("div",{className:" absolute top-1/2 -translate-y-1/2 w-full text-center text-xs text-blue-700 "},l)),e.createElement(h,{m:0,className:"flex-none text-slate-500"},"x"),e.createElement("div",null,e.createElement("div",{className:"line-clamp-2 text-sm break-words"},d))),e.createElement("span",{className:" pt-1 font-semibold text-sm"},e.createElement("span",{className:" font-normal text-xs"},"\u0111"),A(m))),{Option:I}=F,fe=oe({key:"locationVn",get:()=>X(()=>import("./location.16c1c74a.module.js"),[]).then(s=>s.default)}),Ne=()=>{const s=C(Y),o=C(Z),d=C(ee),m=C(te),l=q(ae),g=q(ne),b=se(),c=C(fe),[u,y]=p.exports.useState(c[0]),[T,H]=p.exports.useState(c[0].districts[0]),[z,O]=p.exports.useState(c[0].districts[0].wards[0]),[N,G]=p.exports.useState(c[0].districts[0].id),[P,_]=p.exports.useState(c[0].districts[0].wards[0].id),[k,w]=p.exports.useState(null),[j,R]=p.exports.useState(!1),[x,W]=p.exports.useState("GHN"),M=a=>v(void 0,null,function*(){a.preventDefault();const n=s.listOrder.map(i=>{const t=d.find(f=>f.id===i.id);return{id:t==null?void 0:t.id,name:t==null?void 0:t.nameProduct,quantity:i.order.quantity,price:t==null?void 0:t.salePrice}}),r={totalPrice:o,products:n,shippingFee:k||0,shippingMethod:x,address:{city:u.name,district:T.name,ward:z.name}};yield Ee(r)}),$=a=>{l(!0),g({productId:a,isUpdate:!0})},D=(a,n)=>v(void 0,null,function*(){if(x!=="Pickup"){R(!0);try{const i=yield(yield fetch("https://dev-online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/fee",{method:"POST",headers:{"Content-Type":"application/json",Token:"93cb4daa-150f-11f0-95d0-0a92b8726859",ShopId:"196359"},body:JSON.stringify({from_district_id:227,from_ward_code:"07927",service_id:53321,service_type_id:null,to_district_id:a,to_ward_code:n,height:10,length:20,weight:500,width:15,insurance_value:5e4,cod_failed_amount:0,coupon:null,items:[{name:"Demo Product",quantity:1,height:10,weight:500,length:20,width:15}]})})).json();i.code===200?w(i.data.total):w(null)}catch(r){console.error("GHN Fee Error:",r),w(null)}finally{R(!1)}}}),L=a=>{let n=c,r,i;switch(a.name){case"city":n=c,r=u.id,i=t=>{const f=Number(t)-1>-1?Number(t)-1:0,E=c[f].districts[0],B=E.wards[0];y(c[f]),H(E),G(E.id),O(B),_(B.id),x==="GHN"&&D(E.id,B.id)};break;case"district":n=u.districts,r=N,i=t=>{const f=u.districts.find(E=>E.id===t);if(f){const E=f.wards[0];H(f),G(t),O(E),_(E.id),x==="GHN"&&D(t,E.id)}};break;case"ward":n=T.wards,r=P,i=t=>{_(t),N&&x==="GHN"&&D(N,t)};break;default:n=c,r=void 0,i=()=>{};break}return{listOptions:n,value:r,handleOnSelect:i}};return p.exports.useEffect(()=>{b({title:"\u0110\u01A1n \u0111\u1EB7t h\xE0ng",type:"secondary"}),re("secondary"),x==="GHN"?D(N,P):w(0)},[x]),e.createElement(de,null,s&&e.createElement("div",{className:" mb-[80px]"},e.createElement(h,{m:0,p:4,className:" bg-white"},e.createElement(pe,{store:m,hasRightSide:!1,hasBorderBottom:!1,type:"order"})),e.createElement(h,{mx:3,mb:2},s.listOrder.map(a=>{const n=d.find(r=>r.id===a.id);return e.createElement(xe,{pathImg:n.imgProduct,nameProduct:n.nameProduct,salePrice:n.salePrice,quantity:a.order.quantity,key:n.id,id:a.id,handleOnClick:r=>$(r)})})),e.createElement(h,{m:4,flex:!0,flexDirection:"row",justifyContent:"space-between"},e.createElement("span",{className:" text-base font-medium"},"\u0110\u01A1n h\xE0ng"),e.createElement("span",{className:" text-base font-medium text-primary"},A(o),"\u0111")),e.createElement(h,{m:0,px:4,className:" bg-white"},e.createElement(S,{size:"large",bold:!0,className:" border-b py-3 mb-0"},"Ph\u01B0\u01A1ng th\u1EE9c giao h\xE0ng"),e.createElement("div",{className:"py-3 border-b"},e.createElement(F,{value:x,onChange:a=>{W(a),a==="Pickup"?w(0):D(N,P)}},e.createElement(I,{value:"GHN",title:"GHN (Giao t\u1EADn n\u01A1i)"}),e.createElement(I,{value:"Pickup",title:"T\u1EF1 \u0111\u1EBFn l\u1EA5y h\xE0ng"})))),e.createElement(h,{m:0,px:4,className:" bg-white"},e.createElement(S,{size:"large",bold:!0,className:" border-b py-3 mb-0"},"\u0110\u1ECBa ch\u1EC9 giao h\xE0ng"),he.map(a=>{const{listOptions:n,value:r,handleOnSelect:i}=L(a);return e.createElement("div",{key:a.name,className:V("py-3",a.name!=="ward"&&"border-b")},e.createElement(S,{size:"large",bold:!0,className:"after:content-['_*'] after:text-primary after:align-middle"},a.label),e.createElement(h,{className:"relative",m:0},a.type==="select"?e.createElement(F,{id:a.name,placeholder:a.placeholder,name:a.name,value:r,onChange:t=>{i(t)}},n==null?void 0:n.map(t=>e.createElement(I,{key:t.id,value:t.id,title:t.name}))):e.createElement(ue,{placeholder:"Nh\u1EADp s\u1ED1 nh\xE0, t\xEAn \u0111\u01B0\u1EDDng",clearable:!0})))})),(k!==null||j)&&e.createElement(h,{m:4,flex:!0,flexDirection:"row",justifyContent:"space-between"},e.createElement("span",{className:"text-base font-medium"},"Ph\xED ship"),e.createElement("span",{className:"text-base font-medium text-primary"},j?"\u0110ang t\xEDnh...":`${A(k||0)}\u0111`)),e.createElement(le,{zIndex:99},e.createElement(me,{htmlType:"submit",fullWidth:!0,className:" bg-primary text-white rounded-lg h-12",onClick:M},"\u0110\u1EB7t h\xE0ng")),e.createElement(S,{className:"p-4 text-center"},`\u0110\u1EB7t h\xE0ng \u0111\u1ED3ng ngh\u0129a v\u1EDBi vi\u1EC7c b\u1EA1n \u0111\u1ED3ng \xFD quan t\xE2m 
              ${m.nameStore} 
              \u0111\u1EC3 nh\u1EADn tin t\u1EE9c m\u1EDBi`)))};export{Ne as default};
