var v=(n,i,c)=>new Promise((E,d)=>{var u=s=>{try{y(c.next(s))}catch(x){d(x)}},b=s=>{try{y(c.throw(s))}catch(x){d(x)}},y=s=>s.done?E(s.value):Promise.resolve(s.value).then(u,b);y((c=c.apply(n,i)).next())});import{a as Q,c as R,S as U,I as K,b as S,_ as X,d as Y,e as Z,p as ee,s as te,o as ae,f as ne,u as se,g as re,B as le}from"./index.9bb70c74.module.js";import{x as ce,R as e,I as ie,B as h,b as oe,f as D,u as ue,d as V,r as p,P as de,T as P,S as B,h as me,a as Ee}from"./vendor.1c49cccd.module.js";const he=(n,i,c)=>new Promise((E,d)=>{ce.createOrder({desc:c!=null?c:`Thanh to\xE1n cho ${Q.app.title}`,item:n.products,amount:n.totalPrice+n.shippingFee,success:u=>v(void 0,null,function*(){console.log("Thanh to\xE1n th\xE0nh c\xF4ng:",u),i&&i("/checkout-success")}),fail:u=>{console.log("L\u1ED7i thanh to\xE1n:",u),i&&i("/checkout-fail"),d(u)}})}),pe=[{name:"detail",label:"S\u1ED1 nh\xE0, t\xEAn \u0111\u01B0\u1EDDng",type:"text",placeholder:"Nh\u1EADp s\u1ED1 nh\xE0, t\xEAn \u0111\u01B0\u1EDDng",errorMessage:"H\xE3y nh\u1EADp \u0111\u1ECBa ch\u1EC9 c\u1EE5 th\u1EC3 c\u1EE7a b\u1EA1n",isValidate:!0},{name:"city",label:"T\u1EC9nh, th\xE0nh ph\u1ED1",type:"select",placeholder:"Ch\u1ECDn t\u1EC9nh, th\xE0nh ph\u1ED1...",isValidate:!1},{name:"district",label:"Qu\u1EADn (huy\u1EC7n)",type:"select",placeholder:"Ch\u1ECDn qu\u1EADn, huy\u1EC7n...",isValidate:!1},{name:"ward",label:"Ph\u01B0\u1EDDng (x\xE3)",type:"select",placeholder:"Ch\u1ECDn ph\u01B0\u1EDDng, x\xE3...",isValidate:!1}],xe=({store:n,type:i="standard",handleOnClick:c=()=>{},hasRightSide:E=!0,hasBorderBottom:d=!0,customRightSide:u,className:b})=>e.createElement("div",{key:n.id,className:R("flex flex-row items-center justify-between w-full",d&&" border-b",b&&b),onClick:c,role:"button"},e.createElement("div",{className:"flex flex-row items-center"},e.createElement("div",{className:"w-auto flex-none"},e.createElement("img",{src:n.logoStore,alt:"product",className:" w-9 h-9 object-cover rounded-full bg-white"})),e.createElement("div",{className:" p-3 pr-0"},e.createElement("div",{className:"line-clamp-2 text-sm font-medium break-words"},n.nameStore),i==="standard"&&e.createElement("span",{className:" pt-1 font-semibold text-sm text-gray-500"},U[n.type]))),E&&(u||e.createElement(ie,{size:20,icon:"zi-chevron-right",className:" text-zinc-500"}))),fe=({id:n,pathImg:i,nameProduct:c,salePrice:E,quantity:d,handleOnClick:u})=>e.createElement("div",{className:"w-full flex flex-row items-center justify-between gap-1 border border-[#E4E8EC] rounded-lg overflow-hidden h-24 p-2 mt-2 bg-white",onClick:()=>u(n),role:"button"},e.createElement("div",{className:"flex flex-row items-center gap-1"},e.createElement("div",{className:"flex-none w-20 rounded-lg overflow-hidden"},e.createElement(K,{src:i,alt:"image product",ratio:1})),e.createElement(h,{p:0,m:0,className:" flex-none relative w-5 h-5 rounded-full bg-slate-100"},e.createElement("div",{className:" absolute top-1/2 -translate-y-1/2 w-full text-center text-xs text-blue-700 "},d)),e.createElement(h,{m:0,className:"flex-none text-slate-500"},"x"),e.createElement("div",null,e.createElement("div",{className:"line-clamp-2 text-sm break-words"},c))),e.createElement("span",{className:" pt-1 font-semibold text-sm"},e.createElement("span",{className:" font-normal text-xs"},"\u0111"),S(E))),{Option:A}=B,ge=oe({key:"locationVn",get:()=>X(()=>import("./location.16c1c74a.module.js"),[]).then(n=>n.default)}),we=()=>{const n=D(Y),i=D(Z),c=D(ee),E=D(te),d=ue(),u=V(ae),b=V(ne),y=se(),s=D(ge),[x,W]=p.exports.useState(s[0]),[I,F]=p.exports.useState(s[0].districts[0]),[q,T]=p.exports.useState(s[0].districts[0].wards[0]),[H,O]=p.exports.useState(s[0].districts[0].id),[z,_]=p.exports.useState(s[0].districts[0].wards[0].id),[C,N]=p.exports.useState(null),[G,j]=p.exports.useState(!1),[f,M]=p.exports.useState("GHN"),$=a=>v(void 0,null,function*(){a.preventDefault();const r=n.listOrder.map(o=>{const t=c.find(g=>g.id===o.id);return{id:t==null?void 0:t.id,name:t==null?void 0:t.nameProduct,quantity:o.order.quantity,price:t==null?void 0:t.salePrice}}),l={totalPrice:i,products:r,shippingFee:C||0,shippingMethod:f,address:{city:x.name,district:I.name,ward:q.name}};console.info(l),yield he(l,d)}),L=a=>{u(!0),b({productId:a,isUpdate:!0})},w=(a,r)=>v(void 0,null,function*(){if(f!=="Pickup"){j(!0);try{const o=yield(yield fetch("https://dev-online-gateway.ghn.vn/shiip/public-api/v2/shipping-order/fee",{method:"POST",headers:{"Content-Type":"application/json",Token:"93cb4daa-150f-11f0-95d0-0a92b8726859",ShopId:"196359"},body:JSON.stringify({from_district_id:1444,from_ward_code:"20308",service_id:53321,service_type_id:null,to_district_id:1482,to_ward_code:"21112",height:10,length:20,weight:500,width:15,insurance_value:5e4,cod_failed_amount:0,coupon:null,items:[{name:"Demo Product",quantity:1,height:10,weight:500,length:20,width:15}]})})).json();o.code===200?N(o.data.total):N(null)}catch(l){console.error("GHN Fee Error:",l),N(null)}finally{j(!1)}}}),J=a=>{let r=s,l,o;switch(a.name){case"city":r=s,l=x.id,o=t=>{const g=Number(t)-1>-1?Number(t)-1:0,m=s[g].districts[0],k=m.wards[0];W(s[g]),F(m),O(m.id),T(k),_(k.id),f==="GHN"&&w(m.id,k.id)};break;case"district":r=x.districts,l=H,o=t=>{const g=x.districts.find(m=>m.id===t);if(g){const m=g.wards[0];F(g),O(t),T(m),_(m.id),f==="GHN"&&w(t,m.id)}};break;case"ward":r=I.wards,l=z,o=t=>{_(t),H&&f==="GHN"&&w()};break;default:r=s,l=void 0,o=()=>{};break}return{listOptions:r,value:l,handleOnSelect:o}};return p.exports.useEffect(()=>{y({title:"\u0110\u01A1n \u0111\u1EB7t h\xE0ng",type:"secondary"}),re("secondary"),f==="GHN"?w():N(0)},[f]),e.createElement(de,null,n&&e.createElement("div",{className:" mb-[80px]"},e.createElement(h,{m:0,p:4,className:" bg-white"},e.createElement(xe,{store:E,hasRightSide:!1,hasBorderBottom:!1,type:"order"})),e.createElement(h,{mx:3,mb:2},n.listOrder.map(a=>{const r=c.find(l=>l.id===a.id);return e.createElement(fe,{pathImg:r.imgProduct,nameProduct:r.nameProduct,salePrice:r.salePrice,quantity:a.order.quantity,key:r.id,id:a.id,handleOnClick:l=>L(l)})})),e.createElement(h,{m:4,flex:!0,flexDirection:"row",justifyContent:"space-between"},e.createElement("span",{className:" text-base font-medium"},"\u0110\u01A1n h\xE0ng"),e.createElement("span",{className:" text-base font-medium text-primary"},S(i),"\u0111")),e.createElement(h,{m:0,px:4,className:" bg-white"},e.createElement(P,{size:"large",bold:!0,className:" border-b py-3 mb-0"},"Ph\u01B0\u01A1ng th\u1EE9c giao h\xE0ng"),e.createElement("div",{className:"py-3 border-b"},e.createElement(B,{value:f,onChange:a=>{M(a),a==="Pickup"?N(0):w()}},e.createElement(A,{value:"GHN",title:"GHN (Giao t\u1EADn n\u01A1i)"}),e.createElement(A,{value:"Pickup",title:"T\u1EF1 \u0111\u1EBFn l\u1EA5y h\xE0ng"})))),e.createElement(h,{m:0,px:4,className:" bg-white"},e.createElement(P,{size:"large",bold:!0,className:" border-b py-3 mb-0"},"\u0110\u1ECBa ch\u1EC9 giao h\xE0ng"),pe.map(a=>{const{listOptions:r,value:l,handleOnSelect:o}=J(a);return e.createElement("div",{key:a.name,className:R("py-3",a.name!=="ward"&&"border-b")},e.createElement(P,{size:"large",bold:!0,className:"after:content-['_*'] after:text-primary after:align-middle"},a.label),e.createElement(h,{className:"relative",m:0},a.type==="select"?e.createElement(B,{id:a.name,placeholder:a.placeholder,name:a.name,value:l,onChange:t=>{o(t)}},r==null?void 0:r.map(t=>e.createElement(A,{key:t.id,value:t.id,title:t.name}))):e.createElement(me,{placeholder:"Nh\u1EADp s\u1ED1 nh\xE0, t\xEAn \u0111\u01B0\u1EDDng",clearable:!0})))})),(C!==null||G)&&e.createElement(h,{m:4,flex:!0,flexDirection:"row",justifyContent:"space-between"},e.createElement("span",{className:"text-base font-medium"},"Ph\xED ship:"),e.createElement("span",{className:"text-base font-medium text-primary"},G?"\u0110ang t\xEDnh...":`${S(C||0)}\u0111`),e.createElement("span",{className:"text-base font-medium"},"T\u1ED5ng ti\u1EC1n:"),e.createElement("span",{className:"text-base font-medium text-primary"},S(C+i||0),"\u0111")),e.createElement(le,{zIndex:99},e.createElement(Ee,{htmlType:"submit",fullWidth:!0,className:" bg-primary text-white rounded-lg h-12",onClick:$},"\u0110\u1EB7t h\xE0ng")),e.createElement(P,{className:"p-4 text-center"},`\u0110\u1EB7t h\xE0ng \u0111\u1ED3ng ngh\u0129a v\u1EDBi vi\u1EC7c b\u1EA1n \u0111\u1ED3ng \xFD quan t\xE2m 
              ${E.nameStore} 
              \u0111\u1EC3 nh\u1EADn tin t\u1EE9c m\u1EDBi`)))};export{we as default};
