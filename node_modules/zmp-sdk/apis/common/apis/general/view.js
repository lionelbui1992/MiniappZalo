import o from'./../../../external/@swc/helpers/src/_async_to_generator.mjs.js';import i from'./../../../external/@swc/helpers/src/_class_call_check.mjs.js';import t from'./../../../external/@swc/helpers/src/_object_spread.mjs.js';import n from'./../../../external/@swc/helpers/src/_type_of.mjs.js';import e from"../../../utils/lodash.js";import r from"../../call/index.js";import{HIDE_ACTION_BAR as a,SHOW_ACTION_BAR as s,DEFAULT_HEADER_COLOR as u,MINI_APP_INTERNAL_LINK as d,APP_ID as l,ACTION_LEFT_BUTTON_TYPE as f}from"../../../constants.js";import{StatusBarType as c,AndroidBottomNavigationBarType as v,IOSSafeAreaBottomType as p}from"../../../types/enum.js";import{getStatusbarType as h,convertStatusBarTypeToNumber as m}from"../../../utils/common.js";import{__generator as g}from'./../../../external/tslib/tslib.es6.js';import T from"../../../appEnv/getEnv.js";var B=function(){function B(){var o,t,n,r,c,v,p,h,g,T,C,_,A,y,E,O,w,I,H,b,N,S,j,D,R;i(this,B),this.initConfig=window.APP_CONFIG;var x=e.isString(null===(o=this.initConfig)||void 0===o||null===(t=o.app)||void 0===t?void 0:t.headerColor)&&(null===(n=this.initConfig)||void 0===n||null===(r=n.app)||void 0===r||null===(c=r.headerColor)||void 0===c?void 0:c.length)>0?s:a;this.hideIOSSafeAreaBottom=!!(null===(v=this.initConfig)||void 0===v||null===(p=v.app)||void 0===p?void 0:p.hideIOSSafeAreaBottom),this.hideAndroidBottomNavigationBar=!!(null===(h=this.initConfig)||void 0===h||null===(g=h.app)||void 0===g?void 0:g.hideAndroidBottomNavigationBar);var P,M,G="none"===(null===(T=this.initConfig)||void 0===T||null===(C=T.app)||void 0===C?void 0:C.leftButton)||"home"===(null===(_=this.initConfig)||void 0===_||null===(A=_.app)||void 0===A?void 0:A.leftButton)?f.HIDE_BACK:f.SHOW_BACK,L="home"===(null===(y=this.initConfig)||void 0===y||null===(E=y.app)||void 0===E?void 0:E.leftButton)||"both"===(null===(O=this.initConfig)||void 0===O||null===(w=O.app)||void 0===w?void 0:w.leftButton)?f.SHOW_HOME:f.HIDE_HOME,K=new URL(location.href),U=m(null===(I=this.initConfig)||void 0===I||null===(H=I.app)||void 0===H?void 0:H.statusBar);"boolean"==typeof(null===(b=this.initConfig)||void 0===b||null===(N=b.app)||void 0===N?void 0:N.actionBarHidden)&&(x=(null===(P=this.initConfig)||void 0===P||null===(M=P.app)||void 0===M?void 0:M.actionBarHidden)?a:s);this.config={actionbarType:x,buttonType:G,statusbarType:U,dataConfig:{backgroundColor:(null===(S=this.initConfig)||void 0===S||null===(j=S.app)||void 0===j?void 0:j.headerColor)||u,textColor:(null===(D=this.initConfig)||void 0===D||null===(R=D.app)||void 0===R?void 0:R.textColor)||"",viewInLeftType:G,confirmToExit:1},homeConfig:{enable:L,url:"".concat(d,"/").concat(l,"/").concat(K.search)}}}var C=B.prototype;return C.setNavigationBarTitle=function(i){return o((function(){return g(this,(function(o){return[2,new Promise((function(o,t){r("CHANGE_TITLE_HEADER",{title:i},{success:function(i){o()},fail:function(o){t(o)}},{timeout:!1})}))]}))}))()},C.setNavigationBarLeftButton=function(i){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config.dataConfig.confirmToExit,a=this;return o((function(){var o,s;return g(this,(function(u){return void 0===(void 0===i?"undefined":n(i))&&null===(void 0===i?"undefined":n(i))||(o="none"===i||"home"===i?f.HIDE_BACK:f.SHOW_BACK,s="home"===i||"both"===i?f.SHOW_HOME:f.HIDE_HOME,a.config.buttonType=o,a.config.dataConfig.viewInLeftType=o,a.config.homeConfig.enable=s),a.config.dataConfig.confirmToExit=e,[2,new Promise((function(o,i){r("CHANGE_ACTIONBAR_LEFTBUTTON_TYPE",t({},a.config),{success:function(i){o()},fail:function(o){i(o)}},{timeout:!1})}))]}))}))()},C.setAndroidBottomNavigationBar=function(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return o((function(){var o,n,e;return g(this,(function(a){return n=i?v.hide:v.show,e=null===(o=T())||void 0===o?void 0:o.platform,[2,new Promise((function(o,a){if(!(null==e?void 0:e.isAndroid))return o();r("CHANGE_BOTTOMBAR",{bottombarType:n},{success:function(n){t.hideAndroidBottomNavigationBar=!!i,window.ANDROID_BOTTOM_NAVIGATION_BAR_HIDDEN=!!i,o()},fail:function(o){a(o)}},{timeout:!1})}))]}))}))()},C.setIOSBottomSafeArea=function(){var i=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return o((function(){var o,n,e;return g(this,(function(a){return n=i?p.hide:p.show,e=null===(o=T())||void 0===o?void 0:o.platform,[2,new Promise((function(o,a){if(!(null==e?void 0:e.isIOS))return o();r("CHANGE_BOTTOMBAR",{bottombarType:n},{success:function(n){t.hideIOSSafeAreaBottom=!!i,window.IOS_BOTTOM_SAFE_AREA_HIDDEN=!!i,o()},fail:function(o){a(o)}},{timeout:!1,delay:200})}))]}))}))()},C.configHeader=function(i){var n=this;return o((function(){var o;return g(this,(function(u){return o=n.config,e.isString(i.headerColor)&&(o.dataConfig.backgroundColor=i.headerColor),e.isString(i.headerTextColor)&&(o.dataConfig.textColor=i.headerTextColor),!0===i.hideActionBar?o.actionbarType=a:!1===i.hideActionBar&&(o.actionbarType=s),"normal"===i.statusBarType?o.statusbarType=c.normal:"hidden"===i.statusBarType?o.statusbarType=c.hidden:"transparent"===i.statusBarType&&(o.statusbarType=c.transparent),[2,new Promise((function(e,s){r("CHANGE_ACTIONBAR",t({},o),{success:function(r){var s;n.config=t({},o);var u=null===(s=T())||void 0===s?void 0:s.platform;window.STATUS_BAR_TYPE=h(n.config.statusbarType),window.ACTION_BAR_HIDDEN=n.config.actionbarType===a;var d=null===document||void 0===document?void 0:document.querySelector(":root");if(null==u?void 0:u.isAndroid){var l=0;if(("hidden"===i.statusBarType||"transparent"===i.statusBarType)&&i.hideActionBar){var f=window.ANDROID_STATUS_BAR_HEIGHT;isNaN(f)&&(f=Math.round(ZaloJavaScriptInterface.getStatusBarHeight()/window.devicePixelRatio)),l=f}l?null==d||d.style.setProperty("--zaui-safe-area-inset-top","".concat(l,"px")):null==d||d.style.setProperty("--zaui-safe-area-inset-top","env(safe-area-inset-top, 0px)")}e()},fail:function(o){s(o)}},{timeout:!1})}))]}))}))()},B.getInstance=function(){return B.instance||(B.instance=new B),B.instance},B}().getInstance();export{B as default};
