import t from'./../external/@swc/helpers/src/_class_call_check.mjs.js';import e from'./../external/@swc/helpers/src/_get.mjs.js';import n from'./../external/@swc/helpers/src/_get_prototype_of.mjs.js';import o from'./../external/@swc/helpers/src/_inherits.mjs.js';import r from'./../external/@swc/helpers/src/_create_super.mjs.js';import s from'./../external/eventemitter3/index.js';import c from"../utils/debug.js";import{stringToData as a}from"../utils/common.js";import{APP_ID as i}from"../constants.js";import{Events as l}from"../types/enum.js";var m="ACTION_CALLBACK";var u=function(s){o(i,s);var a=r(i);function i(){var e;return t(this,i),(e=a.call(this)).debug=c("zmp:event-emitter"),e}var u=i.prototype;return u.h5ConfirmHandleEvent=function(t,e,n){ZaloJavaScriptInterface.jsH5EventCallback(t,e,n||"")},u.on=function(t,o,r){var s=this;if(t===m||t===l.PaymentCallback)return e(n(i.prototype),"on",this).call(this,t,o,r);this.debug("register ".concat(String(t),": ").concat(r));return e(n(i.prototype),"on",this).call(this,t,(function(e,n){s.h5ConfirmHandleEvent(e,t,r),o(n)}),r)},u.once=function(t,o,r){var s=this;if(t===m)return e(n(i.prototype),"once",this).call(this,t,o,r);this.debug("register once ".concat(String(t),": ").concat(r));return e(n(i.prototype),"once",this).call(this,t,(function(e,n){s.h5ConfirmHandleEvent(e,t,r),o(n)}),r)},i.getInstance=function(){return i.instance||(i.instance=new i),i.instance},i}(s);function p(t){u.getInstance().on(m,t)}function f(t){u.getInstance().emit(m,t)}window.onNativeMessage=function(t){return function(e){f({serialId:t,result:e})}},window.zaloJSV2={zalo_h5_event_handler:function(t,e,n){var o=c("zmp:zalo_h5_event_handler");o("eventId: ".concat(t,", eventName: ").concat(e,", eventData: ").concat(n));var r=a(n);o("stringToData",r);var s=function(t,e){try{if(t===l.OpenApp){var n=e.url,o=new URL(n),r=o.pathname.split("/zapps/".concat(i))[1];return{path:"".concat(r||"/").concat(o.search)}}return e}catch(t){return e}}(e,r);u.getInstance().emit(e,t,s)}},window.zaloNative2JS={nativeCall:function(t,e,n){u.getInstance().emit(l.PaymentCallback,t,e,n)}};export{u as MPEEmitter,f as fireActionMessage,p as onActionMessage};
